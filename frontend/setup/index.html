<!doctype html>
<html>

<head>
    <title>AngelsGuard.me</title>
    <link rel="stylesheet" type="text/css" href="style_fuck_.css">
    <meta charset="utf-8" />
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" src="../describeyourself/mycss.css">
    <link rel="stylesheet" src="../createsession/mycss.css">

    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

</head>

<body>

    <!-- <fb:login-button scope="public_profile,email" onlogin="checkLoginState();"></fb:login-button> -->
    <!-- <div id="status"></div> -->
    <!-- this is where the website starts. Above should be the script for the facebook api -->
    <div class="container">
        <br>

        <div class="well form-horizontal" action=" " method="post" id="contact_form">
            <fieldset>
                <!-- Form Name -->
                <legend align="center">Attending something?</legend>



                <div class="form-group">
                    <label class="col-md-4 control-label">ID</label>
                    <div class="col-md-4 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-pencil"></i></span>
                            <input name="session_name" placeholder="ID of the session" class="form-control" type="text" id="sessionIdInput">
                        </div>
                        <br>
                        <label>The session ID is a special 6 character ID that your session host should provide to you.</label>
                    </div>
                </div>


                <!-- Success message -->
                <!-- <div class="alert alert-success" role="alert" id="success_message">Success <i class="glyphicon glyphicon-thumbs-up"></i> Thanks for contacting us, we will get back to you shortly.</div> -->

                <!-- Button -->
                <div class="form-group">
                    <label class="col-md-4 control-label"></label>
                    <div class="col-md-4">
                        <button type="submit" class="btn btn-success" onclick="updatesession()">Update <!--<span class="glyphicon glyphicon-send"></span>--></button>
                    </div>
                </div>

            </fieldset>
        </div>
        <div class="well form-horizontal" action=" " method="post" id="createsessionDiv">
            <fieldset>

                <!-- Form Name -->
                <legend align="center">Create an session</legend>



                <div class="form-group">
                    <label class="col-md-4 control-label">Name</label>
                    <div class="col-md-4 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-pencil"></i></span>
                            <input name="session_name" placeholder="Name of the session" class="form-control" type="text" id="nameInput">
                        </div>
                    </div>
                </div>


                <div class="form-group">
                    <label class="col-md-4 control-label">Description</label>
                    <div class="col-md-4 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-user"></i></span>
                            <input name="description" placeholder="Quick summary of session" class="form-control" type="text" id="descriptionInput">
                        </div>
                    </div>
                </div>

                <!-- Success message -->
                <!-- <div class="alert alert-success" role="alert" id="success_message">Success <i class="glyphicon glyphicon-thumbs-up"></i> Thanks for contacting us, we will get back to you shortly.</div> -->

                <!-- Button -->
                <div class="form-group">
                    <label class="col-md-4 control-label"></label>
                    <div class="col-md-4">
                        <button type="submit" class="btn btn-success" onclick="createNewsession()">Create <!--<span class="glyphicon glyphicon-send"></span>--></button>
                    </div>
                </div>

            </fieldset>
        </div>


        <div class="well form-horizontal" action=" " method="post" id="sessionCreatedDiv" hidden>
            <fieldset>

                <!-- Form Name -->
                <legend align="center">session created!</legend>

                <div class="form-group">
                    <label class="col-md-4 control-label">ID</label>
                    <div class="col-md-4 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-key"></i></span>
                            <input name="session_name" placeholder="" class="form-control" type="text" id="idInput" value="YODAWG" disabled>
                        </div>
                        <br>
                        <label>Share this ID with your guests.</label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="col-md-4 control-label">Add angels</label>
                    <div class="col-md-4 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-pencil"></i></span>
                            <input name="session_name" placeholder="Type in an angel's name here" class="form-control awesomplete" type="text" id="addAngelInput" data-list="Sangeet Parashar, Seal, Sandy Herriet">
                        </div>
                    </div>
                </div>

                <div class="form-group" id="jasonAngelSection" hidden>
                    <label class="col-md-4 control-label">#1</label>
                    <div class="col-md-4 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="fa fa-pencil"></i></span>
                            <input name="session_name" value="Sangeet Parashar" class="form-control" type="text" disabled>
                        </div>
                    </div>
                    <a href="#">Remove</a>
                </div>

                <!-- <div class="form-group">
        <label class="col-md-4 control-label">End</label>
        <div class="col-md-4 inputGroupContainer">
            <p id="datepairEnd">
                <input type="text" class="date end" />
                <input type="text" class="time end" />
            </p>
        </div>
    </div> -->

                <div></div>

                <!-- Success message -->
                <!-- <div class="alert alert-success" role="alert" id="success_message">Success <i class="glyphicon glyphicon-thumbs-up"></i> Thanks for contacting us, we will get back to you shortly.</div> -->

                <!-- Button -->
                <div class="form-group">
                    <label class="col-md-4 control-label"></label>
                    <div class="col-md-4">
                        <button type="submit" class="btn btn-success" onclick="addAngel()">Add Angel <!--<span class="glyphicon glyphicon-send"></span>--></button>
                    </div>
                </div>

            </fieldset>
        </div>
    </div>

</body>


<link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap3-dialog/1.34.9/css/bootstrap-dialog.min.css" rel="stylesheet" type="text/css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap3-dialog/1.34.9/js/bootstrap-dialog.min.js"></script>

<script>
    function getParameterByName(name, url) {
        if (!url) {
          url = window.location.href;
        }
        name = name.replace(/[\[\]]/g, "\\$&");
        var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
            results = regex.exec(url);
        if (!results) return null;
        if (!results[2]) return '';
        return decodeURIComponent(results[2].replace(/\+/g, " "));
    }

    function createNewsession(){
        console.log("Create session.");

        var name = document.getElementById("nameInput").value;
        var location = document.getElementById("locationInput").value;
        var description = document.getElementById("descriptionInput").value;

        var postData = {
            name: name,
            location: location,
            description: description,
            userID: "jason"
        };

        console.log("Sending " + JSON.stringify(postData));

        $.post("https://payment.fluentudiscount.com:777/session/create", JSON.stringify(postData), function(data, status){
            var object = JSON.parse(data);
            console.log(JSON.stringify(object));
            if(object.result !== 200){
                console.log("Server error, it seems: " + object.error);

                BootstrapDialog.show({
                    title: "Server error",
                    message: "Sorry my friends for letting you down, the server has failed.\n\nError: " + object.message,
                    type: BootstrapDialog.TYPE_DANGER
                });
            }
            else{
                console.log("Good to go, thanks");

                // BootstrapDialog.show({
                //     title: "session created",
                //     message: "Your session has been created! It's unique ID is: <b>" + object.id + "</b>\n\nShare this with your angels and guests so they can add themselves to your session.",
                //     type: BootstrapDialog.TYPE_SUCCESS
                // });

                document.getElementById("nameInput").value = "";
                document.getElementById("locationInput").value = "";
                document.getElementById("descriptionInput").value = "";

                document.getElementById("idInput").value = object.id;

                document.getElementById("sessionCreatedDiv").hidden = false;
                document.getElementById("createsessionDiv").hidden = true;
            }
        });
    }

    function updateDetails(){
        var outfitInput = document.getElementById("outfitInput");
        var detailsInput = document.getElementById("detailsInput");
        var phoneNumberInput = document.getElementById("phoneNumberInput");

        var updateObject = {
            "userID":"Annie",
            "details": {
                "wearing": outfitInput.value,
                "description": detailsInput.value,
                "photo":""
            },
            "phoneNumber":phoneNumberInput.value
        };

        console.log("Sending " + JSON.stringify(updateObject));

        $.post("https://payment.fluentudiscount.com:777/user/update", JSON.stringify(updateObject), function(data, status){
            var object = JSON.parse(data);
            console.log(JSON.stringify(object));
            if(object.result !== 200){
                console.log("Server error, it seems: " + object.error);

                BootstrapDialog.show({
                    title: "Server error",
                    message: "Sorry my friends for letting you down, the server has failed.\n\nError: " + object.message,
                    type: BootstrapDialog.TYPE_DANGER
                });
            }
            else{
                console.log("Good to go, thanks");

                BootstrapDialog.show({
                    title: "Profile updated",
                    message: "Your profile's been successfully updated!",
                    type: BootstrapDialog.TYPE_SUCCESS
                });
            }
        });
    }

    function infinitesessionCheckedChanged(){
        var checked = document.getElementById("infinitesessionCheckbox").checked;
        console.log("Checked " + checked);

        document.getElementById("durationSection").hidden = checked;
    }
</script>

</html>